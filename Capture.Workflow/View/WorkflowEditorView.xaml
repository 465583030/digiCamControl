<controls:MetroWindow x:Class="Capture.Workflow.View.WorkflowEditorView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Capture.Workflow.View"
        xmlns:viewModel="clr-namespace:Capture.Workflow.ViewModel"
        xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:controls1="clr-namespace:Capture.Workflow.Wpf.Controls"
        xmlns:translation="clr-namespace:CameraControl.Core.Translation;assembly=CameraControl.Core"
        xmlns:Core="clr-namespace:CameraControl.Core;assembly=CameraControl.Core"
        xmlns:dd="urn:gong-wpf-dragdrop"
        mc:Ignorable="d"
                      x:Name="MetroWindow"
        Title="WorkflowEditorView" Height="800" Width="1200">
    <Window.DataContext>
        <viewModel:WorkflowEditorViewModel/>
    </Window.DataContext>
    <Grid>
        <TabControl>
            <TabItem Header="Views">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="1*" MaxWidth="200"/>
                    </Grid.ColumnDefinitions>
                    <ListBox Margin="10" BorderBrush="Black" BorderThickness="0" ItemsSource="{Binding Views}" SelectedItem="{Binding SelectedView}" dd:DragDrop.IsDragSource="True" dd:DragDrop.IsDropTarget="True">
                        <ListBox.Effect>
                            <DropShadowEffect ShadowDepth="1" Color="Gray" BlurRadius="7"  />
                        </ListBox.Effect>
                        <ListBox.ItemTemplate>
                            <DataTemplate >
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="30"/>
                                    </Grid.ColumnDefinitions>
                                    <controls1:EditableTextBlock Text="{Binding Name}"/>
                                    <Rectangle Grid.Column="1">
                                        <Rectangle.Fill>
                                            <VisualBrush Stretch="Uniform">
                                                <VisualBrush.Visual>
                                                    <Path Data="M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z" Fill="Black" />
                                        </VisualBrush.Visual>
                                                </VisualBrush>
                                            </Rectangle.Fill>
                                    </Rectangle>
                                </Grid>
                             </DataTemplate>   
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <StackPanel Grid.Row="1" Grid.Column="0">
                        <controls:DropDownButton Name="AddNewViewButton" Margin="20,5" VerticalContentAlignment="Center" Content="Add view" DisplayMemberPath="Name" 
                                                             ItemsSource="{Binding ViewsPlugins}">
                            <controls:DropDownButton.ItemContainerStyle>
                                <Style TargetType="MenuItem">
                                    <Setter Property="Command" Value="{Binding DataContext.NewViewCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:WorkflowEditorView}}}"/>
                                    <Setter Property="CommandParameter" Value="{Binding}"/>
                                </Style>
                            </controls:DropDownButton.ItemContainerStyle>
                            <!--<controls:DropDownButton.Icon>
                                <Rectangle Width="20" Height="20">
                                    <Rectangle.Fill>
                                        <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_add}" />
                                    </Rectangle.Fill>
                                </Rectangle>
                            </controls:DropDownButton.Icon>-->
                        </controls:DropDownButton>
                        <Button Content="Delete view" Margin="20,5"/>
                    </StackPanel>
                    <!--<GroupBox.Effect>
                            <DropShadowEffect ShadowDepth="1" Color="Gray" BlurRadius="7"  />
                        </GroupBox.Effect>-->
                    <Grid Grid.Row="0" Grid.Column="1" Grid.RowSpan="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="274*"/>
                            <RowDefinition Height="201*"/>
                        </Grid.RowDefinitions>
                        <GroupBox Grid.Row="0" Header="UI Elements">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*"/>
                                    <ColumnDefinition Width="1*"/>
                                </Grid.ColumnDefinitions>
                                <ListBox Margin="10" BorderBrush="Black" BorderThickness="0" ItemsSource="{Binding SelectedView.Elements}" SelectedItem="{Binding SelectedElement}" dd:DragDrop.IsDragSource="True" dd:DragDrop.IsDropTarget="True">
                                    <ListBox.Effect>
                                        <DropShadowEffect ShadowDepth="1" Color="Gray" BlurRadius="7"  />
                                    </ListBox.Effect>
                                    <ListBox.ItemTemplate>
                                        <DataTemplate >
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="30"/>
                                                </Grid.ColumnDefinitions>
                                                <controls1:EditableTextBlock Text="{Binding Name}"/>
                                                <Rectangle Grid.Column="1">
                                                    <Rectangle.Fill>
                                                        <VisualBrush Stretch="Uniform">
                                                            <VisualBrush.Visual>
                                                                <Path Data="M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z" Fill="Black" />
                                                            </VisualBrush.Visual>
                                                        </VisualBrush>
                                                    </Rectangle.Fill>
                                                </Rectangle>
                                            </Grid>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                                <controls1:PropertyEditor Grid.Row="0" Grid.Column="1" Grid.RowSpan="2"
                                                          DataContext="{Binding SelectedElement.Properties}" />
                                <StackPanel Grid.Row="1" Grid.Column="0">
                                    <controls:DropDownButton  Margin="20,5" VerticalContentAlignment="Center" Content="Add element" DisplayMemberPath="Name" 
                                                             ItemsSource="{Binding ViewElementsPlugins}">
                                        <controls:DropDownButton.ItemContainerStyle>
                                            <Style TargetType="MenuItem">
                                                <Setter Property="Command" Value="{Binding DataContext.NewViewElementCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:WorkflowEditorView}}}"/>
                                                <Setter Property="CommandParameter" Value="{Binding}"/>
                                            </Style>
                                        </controls:DropDownButton.ItemContainerStyle>
                                        <!--<controls:DropDownButton.Icon>
                                <Rectangle Width="20" Height="20">
                                    <Rectangle.Fill>
                                        <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_add}" />
                                    </Rectangle.Fill>
                                </Rectangle>
                            </controls:DropDownButton.Icon>-->
                                    </controls:DropDownButton>
                                    <Button Content="Delete element" Margin="20,5"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>
                        <GroupBox Grid.Row="1" Header="View properties">
                            <controls1:PropertyEditor DataContext="{Binding SelectedView.Properties}" />
                        </GroupBox>
                    </Grid>
                    <GroupBox Grid.Row="0" Grid.Column="2" Header="Commands">
                        <StackPanel>
                            <Button Content="Preview" Margin="3" Command="{Binding PreviewViewCommand}"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>
            <TabItem Header="Actions">
                <Grid>

                </Grid>
            </TabItem>
            <TabItem Header="Events">
                <Grid>

                </Grid>
            </TabItem>
            <TabItem Header="Variables">
                <Grid>

                </Grid>
            </TabItem>
            <TabItem Header="Settings">
                <Grid>

                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</controls:MetroWindow>

